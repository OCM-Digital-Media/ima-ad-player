!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ImaAdPlayer=t():e.ImaAdPlayer=t()}(window,function(){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){"use strict";function a(e){return!isNaN(parseFloat(e))&&isFinite(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isNumeric=a,t.makeNum=function(e,t){return a(e)?e+0:t},t.makeDefault=function(e,t){return void 0===e?t:e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,a.default)(function(i){if(!i)return t(null,new Error("Failed to load IMA SDK"));t(new n.default(e),null)},(0,o.makeNum)(e.timemout,6e3),!!e.debug)};var a=s(i(2)),n=s(i(3)),o=i(0);function s(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e3,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=window,n=document,o=null,s=function(t){a.clearTimeout(o),"function"==typeof e&&e(t)};if(a.google&&a.google.ima)return s(!0);var r=n.getElementsByTagName("script")[0],d=n.createElement("script");d.src="https://imasdk.googleapis.com/js/sdkloader/ima3"+(i?"_debug":"")+".js",d.async=!0,"function"==typeof e&&(d.onload=function(){s(!0)});r.parentNode.insertBefore(d,r),t&&(o=a.setTimeout(function(){s(!1)},t))},e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,n=i(0),o=(a=i(4))&&a.__esModule?a:{default:a};function s(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._configure(t),this._evt=new o.default,this._adRequesting=!1,this._adRequested=!1,google.ima.settings.setVpaidMode(this._vpaidMode),this._o.locale&&google.ima.settings.setLocale(this._o.locale),this._adDisplayContainer=new google.ima.AdDisplayContainer(this._o.displayContainer,this._o.video)}var t,i,a;return t=e,(i=[{key:"_configure",value:function(e){this._o={displayContainer:e.displayContainer,video:e.video,tag:e.tag},this._o.vpaidMode=(0,n.makeNum)(e.vpaidMode,0),e.maxDuration&&(this._o.maxDuration=(0,n.makeNum)(e.maxDuration,void 0)),this._o.adsRequestOptions=e.adsRequestOptions,this._o.adsRenderingOptions=e.adsRenderingOptions,this._o.nonLinearMaxDuration=(0,n.makeNum)(e.nonLinearMaxDuration,-1),this._o.adWillAutoPlay=!!(0,n.makeDefault)(e.adWillAutoPlay,!0),this._o.adWillPlayMuted=!!(0,n.makeDefault)(e.adWillPlayMuted,!1),this._o.restoreVideo=!!(0,n.makeDefault)(e.restoreVideo,!1)}},{key:"_setProperties",value:function(e,t){for(var i in t)e[i]&&(e[i]=t[i])}},{key:"on",value:function(e,t){this._evt.subscribe(e,t)}},{key:"off",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t?this._evt.unsubscribeAll(e):this._evt.unsubscribe(e,t)}},{key:"play",value:function(){var e=this;this._dispatch("ad_play_intent"),this._adPlayIntent=!0,this._userInteraction(function(){e._requestAd()})}},{key:"request",value:function(e){this._dispatch("ad_request_intent",e),this._requestAd(e)}},{key:"resize",value:function(e,t){this._adsManager&&this._adsManager.resize(e,t,google.ima.ViewMode.NORMAL)}},{key:"setVolume",value:function(e){this._adsManager&&this._adsManager.setVolume(e)}},{key:"setAdWillAutoPlay",value:function(e){this._o.adWillAutoPlay=e}},{key:"setAdWillPlayMuted",value:function(e){this._o.adWillPlayMuted=e}},{key:"stop",value:function(){this._dispatch("ad_stop_intent"),this._stop()}},{key:"ended",value:function(){this._adsLoader&&this._adsLoader.contentComplete()}},{key:"initAdDisplayContainer",value:function(){this._adDisplayContainer.initialize()}},{key:"destroy",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._end||(this._resetMaxDurationTimer(),e&&this._evt.unsubscribeAll(),this._adsManager&&this._adsManager.stop()),this._destroyAdsManager(),this._adsLoader&&this._adsLoader.destroy(),this._adDisplayContainer&&this._adDisplayContainer.destroy()}},{key:"_userInteraction",value:function(e){var t=this;this.initAdDisplayContainer(),this._o.video.load||e();var i=function i(){t._o.video.removeEventListener("loadedmetadata",i,!1),t._o.video.removeEventListener("error",i,!1),e()};this._o.video.addEventListener("loadedmetadata",i,!1),this._o.video.addEventListener("error",i,!1),this._o.video.load()}},{key:"_stop",value:function(){this._dispatch("ad_stop"),this._adsManager?this._adsManager.stop():this._endAd()}},{key:"_makeAdsLoader",value:function(){var e=this;this._adsLoader=new google.ima.AdsLoader(this._adDisplayContainer),this._adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(t){e._onAdsManagerLoaded(t)}),this._adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(t){e._onAdError(t)})}},{key:"_requestAd",value:function(e){if(this._end=!1,!this._adRequesting)if(this._adRequested)this._adPlayIntent&&this._playAd();else{this._adRequesting=!0,this._adsLoader||this._makeAdsLoader();var t=new google.ima.AdsRequest;t.adTagUrl=this._o.tag,t.linearAdSlotWidth=this._o.video.offsetWidth,t.linearAdSlotHeight=this._o.video.offsetHeight,t.nonLinearAdSlotWidth=this._o.video.offsetWidth,t.nonLinearAdSlotHeight=this._o.video.offsetHeight,t.setAdWillAutoPlay(this._o.adWillAutoPlay),t.setAdWillPlayMuted(this._o.adWillPlayMuted);var i=e||this._o.adsRequestOptions;i&&this._setProperties(t,i),this._dispatch("ad_request",t),this._adsLoader.requestAds(t)}}},{key:"_destroyAdsManager",value:function(){this._adsManager&&(this._adsManager.destroy(),delete this._adsManager)}},{key:"_bindAdsManagerEvents",value:function(){var e=this;this._adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(t){e._onAdError(t)}),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(t){e._end=!1,e._dispatch("content_pause_requested",t),e._dispatch("ad_begin")}),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(t){e._dispatch("content_resume_requested",t),e._endAd()}),this._adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,function(t){e._dispatch("started",t);var i=t.getAd();if(i.isLinear())e._o.maxDuration&&e._startMaxDurationTimer();else{var a=e._o.nonLinearMaxDuration;e._dispatch("ad_non_linear",{ad:i,duration:a}),e._o.nonLinearMaxDuration>0&&setTimeout(function(){e._adsManager&&e._adsManager.stop()},e._o.nonLinearMaxDuration),e._endAd()}});var t={ad_break_ready:google.ima.AdEvent.Type.AD_BREAK_READY,ad_buffering:google.ima.AdEvent.Type.AD_BUFFERING,ad_metadata:google.ima.AdEvent.Type.AD_METADATA,ad_progress:google.ima.AdEvent.Type.AD_PROGRESS,all_ads_completed:google.ima.AdEvent.Type.ALL_ADS_COMPLETED,click:google.ima.AdEvent.Type.CLICK,complete:google.ima.AdEvent.Type.COMPLETE,duration_change:google.ima.AdEvent.Type.DURATION_CHANGE,first_quartile:google.ima.AdEvent.Type.FIRST_QUARTILE,impression:google.ima.AdEvent.Type.IMPRESSION,interaction:google.ima.AdEvent.Type.INTERACTION,linear_changed:google.ima.AdEvent.Type.LINEAR_CHANGED,loaded:google.ima.AdEvent.Type.LOADED,log:google.ima.AdEvent.Type.LOG,midpoint:google.ima.AdEvent.Type.MIDPOINT,paused:google.ima.AdEvent.Type.PAUSED,resumed:google.ima.AdEvent.Type.RESUMED,skippable_state_changed:google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,skipped:google.ima.AdEvent.Type.SKIPPED,third_quartile:google.ima.AdEvent.Type.THIRD_QUARTILE,user_close:google.ima.AdEvent.Type.USER_CLOSE,volume_changed:google.ima.AdEvent.Type.VOLUME_CHANGED,volume_muted:google.ima.AdEvent.Type.VOLUME_MUTED};google.ima.AdEvent.Type.AD_CAN_PLAY&&(t.ad_can_play=google.ima.AdEvent.Type.AD_CAN_PLAY),google.ima.AdEvent.Type.VIEWABLE_IMPRESSION&&(t.viewable_impression=google.ima.AdEvent.Type.VIEWABLE_IMPRESSION);var i=function(i){e._adsManager.addEventListener(t[i],function(t){e._dispatch(i,t)})};for(var a in t)i(a)}},{key:"_onAdsManagerLoaded",value:function(e){this._dispatch("ads_manager_loaded",e);var t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=this._o.restoreVideo,this._o.adsRenderingOptions&&this._setProperties(t,this._o.adsRenderingOptions),this._dispatch("ads_rendering_settings",t),this._destroyAdsManager(),this._adsManager=e.getAdsManager(this._o.video,t),this._bindAdsManagerEvents(),this._dispatch("ads_manager",this._adsManager),this._adRequesting=!1,this._adRequested=!0,this._adPlayIntent&&this._playAd()}},{key:"_onMaxDuration",value:function(){this._dispatch("error",new Error("Maximum duration of "+this._o.maxDuration+" ms reached")),this._stop()}},{key:"_startMaxDurationTimer",value:function(){var e=this;this._maxDurationTimer=setTimeout(function(){e._onMaxDuration()},this._o.maxDuration)}},{key:"_resetMaxDurationTimer",value:function(){"number"==typeof this._maxDurationTimer&&(clearTimeout(this._maxDurationTimer),this._maxDurationTimer=void 0)}},{key:"_onAdError",value:function(e){this._dispatch("ad_error",e),this._endAd()}},{key:"_playAd",value:function(){try{this._dispatch("ad_play"),this._adsManager.init(this._o.video.offsetWidth,this._o.video.offsetHeight,google.ima.ViewMode.NORMAL),this._adsManager.start()}catch(e){this._dispatch("error",e),this._endAd()}}},{key:"_dispatch",value:function(e,t){this._evt.notify(e,{name:e,data:t,target:this})}},{key:"_endAd",value:function(){this._end||(this._end=!0,this._adPlayIntent=!1,this._adRequesting=!1,this._adRequested=!1,this._resetMaxDurationTimer(),this._dispatch("ad_end"))}},{key:"_vpaidMode",get:function(){return 0===this._o.vpaidMode?google.ima.ImaSdkSettings.VpaidMode.DISABLED:this._o.vpaidMode>1?google.ima.ImaSdkSettings.VpaidMode.INSECURE:google.ima.ImaSdkSettings.VpaidMode.ENABLED}}])&&s(t.prototype,i),a&&s(t,a),e}();t.default=r,e.exports=t.default},function(e,t,i){"use strict";function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.unsubscribeAll()}var t,i,n;return t=e,(i=[{key:"subscribe",value:function(e,t){this.observers[e]||(this.observers[e]=[]),this.observers[e].push(t)}},{key:"unsubscribe",value:function(e,t){if(this.observers[e]){var i=this.observers[e].indexOf(t);-1!=i&&this.observers[e].splice(i,1)}}},{key:"unsubscribeAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===e?this.observers={}:this.observers[e]&&delete this.observers[e]}},{key:"notify",value:function(e,t){this.observers[e]&&this.observers[e].forEach(function(e){return e(t)})}}])&&a(t.prototype,i),n&&a(t,n),e}();t.default=n,e.exports=t.default}])});